import{f as z,g as x,o as r,h as Z,i as ee,w as j,a as i,b as h,j as K,t as P,k as b,r as m,T as te,l as ne,m as oe,v as se,c as w,n as ae,p as F,q as y,s as le,x as ie,y as de,F as M,z as U,A as k,B as re}from"./BJL-sWJ8.js";import{b as N,o as W,f as L,c as S,a as ce}from"./yL3YJtqF.js";const ue={class:"w-12 h-12 flex items-center justify-center rounded-lg"},fe={class:"w-16 text-slate-100 text-xs leading-tight text-center break-all"},pe=z({__name:"DesktopFolder",props:{label:{},icon:{}},emits:["open"],setup(u,{emit:c}){const o=c;return(f,s)=>{const t=K,n=Z;return r(),x(n,{variant:"ghost",class:"flex flex-col items-center w-20 gap-1 backdrop-blur-sm",tabindex:"0",onDblclick:s[0]||(s[0]=e=>o("open")),onKeyup:s[1]||(s[1]=ee(e=>o("open"),["enter"]))},{default:j(()=>[i("div",ue,[h(t,{name:u.icon||"i-lucide-folder",class:"w-7 h-7 text-purple-100 drop-shadow","aria-hidden":"true"},null,8,["name"])]),i("span",fe,P(u.label),1)]),_:1})}}}),ve=Object.assign(pe,{__name:"DesktopFolder"}),me={class:"flex items-center text-white"},he={class:"text-sm font-semibold truncate"},be={class:"flex items-center ml-auto gap-1"},xe=["aria-label"],we={class:"flex-1 min-h-0 p-3 bg-white/70 dark:bg-slate-900/70 text-slate-800 dark:text-slate-100 text-sm overflow-auto rounded-b-md border-t border-white/30 dark:border-slate-800/70"},I="inline-flex items-center justify-center w-6 h-6 rounded-sm bg-white/10 border border-white/30 text-white hover:bg-white/20 active:bg-white/30 cursor-pointer",ge=z({__name:"DesktopWindow",props:{visible:{type:Boolean,default:!1},title:{default:null},draggable:{type:Boolean,default:!1},initialOffsetX:{default:0},initialOffsetY:{default:0},folderId:{},zIndex:{},hidden:{type:Boolean,default:!1},icon:{default:null}},emits:["update:visible","update:hidden","close"],setup(u,{emit:c}){const o=u,f=c,s=b({get:()=>o.visible,set:l=>f("update:visible",l)}),t=b({get:()=>o.hidden??!1,set:l=>f("update:hidden",l)}),n=m(null),e=m(o.initialOffsetX),a=m(o.initialOffsetY),p=m(!1),D=m(0),$=m(0),R=b(()=>p.value?{left:"0",top:"0",transform:"none",width:"100vw",height:"calc(100vh - 48px)",zIndex:o.zIndex??1}:{transform:`translate(calc(-50% + ${e.value}px), calc(-50% + ${a.value}px))`,left:"50%",top:"50%",zIndex:o.zIndex??1}),T=()=>{o.folderId&&N(o.folderId)};let g=!1,C=0,B=0;const O=b(()=>o.draggable&&!p.value),V=l=>{O.value&&(g=!0,C=l.clientX-e.value,B=l.clientY-a.value,window.addEventListener("pointermove",X),window.addEventListener("pointerup",q,{once:!0}))},X=l=>{if(!g||!n.value)return;const d=n.value.getBoundingClientRect(),v=l.clientX-C,_=l.clientY-B,Y=(window.innerWidth-d.width)/2,J=-Y,E=(window.innerHeight-d.height)/2,Q=-E;e.value=Math.min(Math.max(v,J),Y),a.value=Math.min(Math.max(_,Q),E)},q=()=>{g=!1,window.removeEventListener("pointermove",X)},A=()=>{p.value?(p.value=!1,e.value=D.value,a.value=$.value):(D.value=e.value,$.value=a.value,p.value=!0)},H=()=>{t.value=!0},G=()=>{s.value&&(s.value=!1,f("close"))};return(l,d)=>{const v=K;return r(),x(te,{to:"body"},[s.value?ne((r(),w("div",{key:0,ref_key:"panel",ref:n,class:"absolute flex flex-col min-w-90 border shadow-xl backdrop-blur-md bg-white/70 dark:bg-slate-900/70 border-purple-200/60 dark:border-purple-500/50",style:ae(R.value),onPointerdown:T},[i("div",{class:"flex items-center justify-between p-1.5 gap-2 bg-purple-500/20 select-none overflow-hidden",onPointerdown:d[2]||(d[2]=_=>O.value?V(_):void 0)},[i("div",me,[h(v,{name:u.icon||"i-lucide-window",class:"h-5 w-5 mr-2","aria-hidden":"true"},null,8,["name"]),i("h3",he,P(u.title),1)]),i("div",be,[i("button",{type:"button",class:y(I),"aria-label":"Minimize window",onPointerdown:d[0]||(d[0]=F(()=>{},["stop"])),onClick:H},[h(v,{name:"i-lucide-minus",class:"h-4 w-4","aria-hidden":"true"})],32),i("button",{type:"button",class:y(I),"aria-label":p.value?"Restore window":"Maximize window",onClick:A},[h(v,{name:p.value?"i-lucide-copy":"i-lucide-square",class:"h-4 w-4","aria-hidden":"true"},null,8,["name"])],8,xe),i("button",{type:"button",class:y(I),"aria-label":"Window Close",onPointerdown:d[1]||(d[1]=F(()=>{},["stop"])),onClick:G},[h(v,{name:"i-lucide-x",class:"h-4 w-4","aria-hidden":"true"})],32)])],32),i("div",we,[le(l.$slots,"default")])],36)),[[se,!t.value]]):oe("",!0)])}}}),_e=Object.assign(ge,{__name:"DesktopWindow"}),ye={class:"h-full"},ke={class:"absolute z-10 left-4 top-4 flex flex-col gap-4"},De=z({__name:"index",setup(u){const c=t=>L.find(n=>n.id===t),o=t=>{c(t)&&ce(t)},f=b(()=>W.value.filter(t=>t.visible&&!t.hidden).sort((t,n)=>(t.zIndex??0)-(n.zIndex??0))),s=t=>{if(t.key==="Escape"){const n=f.value.at(-1);n&&S(n.folderId)}if(t.altKey&&t.key.toLowerCase()==="tab"){t.preventDefault();const n=f.value;if(!n.length)return;const e=n.at(-2)??n.at(-1);e&&N(e.folderId)}};return ie(()=>{window.addEventListener("keydown",s)}),de(()=>{window.removeEventListener("keydown",s)}),(t,n)=>(r(),w("div",ye,[i("div",ke,[(r(!0),w(M,null,U(k(L),e=>(r(),x(ve,{key:e.id,label:e.name,icon:e.icon,onOpen:a=>o(e.id)},null,8,["label","icon","onOpen"]))),128))]),(r(!0),w(M,null,U(k(W),e=>(r(),x(_e,{key:e.folderId,visible:e.visible,"onUpdate:visible":a=>e.visible=a,hidden:e.hidden,"onUpdate:hidden":a=>e.hidden=a,title:c(e.folderId)?.name??"",draggable:!0,"initial-offset-x":e.offsetX,"initial-offset-y":e.offsetY,"folder-id":e.folderId,"z-index":e.zIndex,icon:c(e.folderId)?.icon,onClose:a=>k(S)(e.folderId)},{default:j(()=>[(r(),x(re(c(e.folderId)?.component)))]),_:2},1032,["visible","onUpdate:visible","hidden","onUpdate:hidden","title","initial-offset-x","initial-offset-y","folder-id","z-index","icon","onClose"]))),128))]))}});export{De as default};
